<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Diabetes Assistant</title>
  <style>
    body { font-family: Arial; margin: 20px; }
    .chat { border: 1px solid #ddd; padding: 10px; height: 300px; overflow: auto; margin-bottom: 10px; }
    input, button { padding: 6px; margin: 4px; }
  </style>
</head>
<body>
  <h2>Diabetes Assistant Chatbot</h2>
  <div class="chat" id="chat"></div>
  <div>
    <input id="Glucose" type="number" placeholder="Glucose" value="120">
    <input id="BMI" type="number" placeholder="BMI" value="28">
    <input id="Age" type="number" placeholder="Age" value="45">
    <button onclick="send()">Check</button>
  </div>

  <script>
    function append(kind, msg) {
      const chat = document.getElementById("chat");
      const div = document.createElement("div");
      div.textContent = kind + ": " + msg;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    async function send() {
      const payload = {
        Pregnancies: 0,
        Glucose: parseFloat(document.getElementById("Glucose").value),
        BloodPressure: 70,
        SkinThickness: 20,
        Insulin: 85,
        BMI: parseFloat(document.getElementById("BMI").value),
        DiabetesPedigreeFunction: 0.5,
        Age: parseFloat(document.getElementById("Age").value)
      };
      append("User", JSON.stringify(payload));
      try {
        const res = await fetch("http://127.0.0.1:5000/predict", {
          method: "POST",
          headers: {"Content-Type":"application/json"},
          body: JSON.stringify(payload)
        });
        const data = await res.json();
        append("Bot", `${data.user_label} â€” ${data.short_advice} (why: ${data.explanation})`);
      } catch (err) {
        append("Error", err.toString());
      }
    }
  </script>
</body>
</html>
